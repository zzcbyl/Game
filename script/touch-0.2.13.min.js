/* touchjs.min v0.2.13  2014-02-24 */
"use strict";!function(d,c){"function"==typeof define&&(define.amd||define.cmd)?define(c):d.touch=c()}(this,function(){function aj(){var b="mouseup mousedown mousemove mouseout",f="touchstart touchmove touchend touchcancel",e=ai.hasTouch?f:b;e.split(" ").forEach(function(c){document.addEventListener(c,T,!1)})}var ai={};ai.PCevts={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",touchcancel:"mouseout"},ai.hasTouch="ontouchstart" in window,ai.getType=function(b){return Object.prototype.toString.call(b).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},ai.getSelector=function(d){if(d.id){return"#"+d.id}if(d.className){var c=d.className.split(/\s+/);return"."+c.join(".")}return d===document?"body":d.tagName.toLowerCase()},ai.matchSelector=function(d,c){return d.webkitMatchesSelector(c)},ai.getEventListeners=function(b){return b.listeners},ai.getPCevts=function(b){return this.PCevts[b]||b},ai.forceReflow=function(){var f="reflowDivBlock",e=document.getElementById(f);e||(e=document.createElement("div"),e.id=f,document.body.appendChild(e));var h=e.parentNode,g=e.nextSibling;h.removeChild(e),h.insertBefore(e,g)},ai.simpleClone=function(b){return Object.create(b)},ai.getPosOfEvent=function(g){if(this.hasTouch){for(var f=[],j=null,i=0,h=g.touches.length;h>i;i++){j=g.touches[i],f.push({x:j.pageX,y:j.pageY})}return f}return[{x:g.pageX,y:g.pageY}]},ai.getDistance=function(f,e){var h=e.x-f.x,g=e.y-f.y;return Math.sqrt(h*h+g*g)},ai.getFingers=function(b){return b.touches?b.touches.length:1},ai.calScale=function(f,e){if(f.length>=2&&e.length>=2){var h=this.getDistance(f[1],f[0]),g=this.getDistance(e[1],e[0]);return g/h}return 1},ai.getAngle=function(d,c){return 180*Math.atan2(c.y-d.y,c.x-d.x)/Math.PI},ai.getAngle180=function(e,d){var f=Math.atan(-1*(d.y-e.y)/(d.x-e.x))*(180/Math.PI);return 0>f?f+180:f},ai.getDirectionFromAngle=function(e){var d={up:-45>e&&e>-135,down:e>=45&&135>e,left:e>=135||-135>=e,right:e>=-45&&45>=e};for(var f in d){if(d[f]){return f}}return null},ai.getXYByElement=function(e){for(var d=0,f=0;e.offsetParent;){d+=e.offsetLeft,f+=e.offsetTop,e=e.offsetParent}return{left:d,top:f}},ai.reset=function(){ac=ab=aa=null,S=V=Z=Y=!1,X=!1,ae={},M=!1},ai.isTouchMove=function(b){return"touchmove"===b.type||"mousemove"===b.type},ai.isTouchEnd=function(b){return"touchend"===b.type||"mouseup"===b.type||"touchcancel"===b.type},ai.env=function(){var i={},h=navigator.userAgent,n=h.match(/(Android)[\s\/]+([\d\.]+)/),m=h.match(/(iPad|iPhone|iPod)\s+OS\s([\d_\.]+)/),l=h.match(/(Windows\s+Phone)\s([\d\.]+)/),k=/WebKit\/[\d.]+/i.test(h),j=m?navigator.standalone?k:/Safari/i.test(h)&&!/CriOS/i.test(h)&&!/MQQBrowser/i.test(h):!1;return n&&(i.android=!0,i.version=n[2]),m&&(i.ios=!0,i.version=m[2].replace(/_/g,"."),i.ios7=/^7/.test(i.version),"iPad"===m[1]?i.ipad=!0:"iPhone"===m[1]?(i.iphone=!0,i.iphone5=568==screen.height):"iPod"===m[1]&&(i.ipod=!0)),l&&(i.wp=!0,i.version=l[2],i.wp8=/^8/.test(i.version)),k&&(i.webkit=!0),j&&(i.safari=!0),i}();var ah={proxyid:0,proxies:[],trigger:function(h,g,l){l=l||{};var k,j={bubbles:!0,cancelable:!0,detail:l};try{"undefined"!=typeof CustomEvent?(k=new CustomEvent(g,j),h&&h.dispatchEvent(k)):(k=document.createEvent("CustomEvent"),k.initCustomEvent(g,!0,!0,l),h&&h.dispatchEvent(k))}catch(i){console.warn("Touch.js is not supported by environment.")}},bind:function(b,h,g){b.listeners=b.listeners||{},b.listeners[h]?b.listeners[h].push(g):b.listeners[h]=[g];var f=function(d){ai.env.ios7&&ai.forceReflow(),d.originEvent=d;for(var j in d.detail){"type"!==j&&(d[j]=d.detail[j])}d.startRotate=function(){M=!0};var i=g.call(d.target,d);"undefined"==typeof i||i||(d.stopPropagation(),d.preventDefault())};g.proxy=g.proxy||{},g.proxy[h]?g.proxy[h].push(this.proxyid++):g.proxy[h]=[this.proxyid++],this.proxies.push(f),b.addEventListener&&b.addEventListener(h,f,!1)},unbind:function(g,f,j){if(j){var i=j.proxy[f];i&&i.length&&i.forEach(function(){g.removeEventListener&&g.removeEventListener(f,this.proxies[this.proxyid],!1)})}else{var h=g.listeners[f];h&&h.length&&h.forEach(function(a){g.removeEventListener(f,a,!1)})}},delegate:function(b,j,i,h){var g=function(o){var n,m;o.originEvent=o;for(var l in o.detail){"type"!==l&&(o[l]=o.detail[l])}o.startRotate=function(){M=!0};var e=ai.getSelector(b)+" "+i,d=ai.matchSelector(o.target,e),a=ai.matchSelector(o.target,e+" "+o.target.nodeName);if(!d&&a){for(ai.env.ios7&&ai.forceReflow(),n=o.target;!ai.matchSelector(n,e);){n=n.parentNode}m=h.call(o.target,o),"undefined"==typeof m||m||(o.stopPropagation(),o.preventDefault())}else{ai.env.ios7&&ai.forceReflow(),(d||a)&&(m=h.call(o.target,o),"undefined"==typeof m||m||(o.stopPropagation(),o.preventDefault()))}};h.proxy=h.proxy||{},h.proxy[j]?h.proxy[j].push(this.proxyid++):h.proxy[j]=[this.proxyid++],this.proxies.push(g),b.listeners=b.listeners||{},b.listeners[j]?b.listeners[j].push(g):b.listeners[j]=[g],b.addEventListener&&b.addEventListener(j,g,!1)},undelegate:function(h,g,l,k){if(k){var j=k.proxy[g];j.length&&j.forEach(function(){h.removeEventListener&&h.removeEventListener(g,this.proxies[this.proxyid],!1)})}else{var i=h.listeners[g];i.forEach(function(a){h.removeEventListener(g,a,!1)})}}},ag={tap:!0,doubleTap:!0,tapMaxDistance:10,hold:!0,tapTime:200,holdTime:650,maxDoubleTapInterval:300,swipe:!0,swipeTime:300,swipeMinDistance:18,swipeFactor:5,drag:!0,pinch:!0,minScaleRate:0,minRotationAngle:0},af={TOUCH_START:"touchstart",TOUCH_MOVE:"touchmove",TOUCH_END:"touchend",TOUCH_CANCEL:"touchcancel",MOUSE_DOWN:"mousedown",MOUSE_MOVE:"mousemove",MOUSE_UP:"mouseup",CLICK:"click",PINCH_START:"pinchstart",PINCH_END:"pinchend",PINCH:"pinch",PINCH_IN:"pinchin",PINCH_OUT:"pinchout",ROTATION_LEFT:"rotateleft",ROTATION_RIGHT:"rotateright",ROTATION:"rotate",SWIPE_START:"swipestart",SWIPING:"swiping",SWIPE_END:"swipeend",SWIPE_LEFT:"swipeleft",SWIPE_RIGHT:"swiperight",SWIPE_UP:"swipeup",SWIPE_DOWN:"swipedown",SWIPE:"swipe",DRAG:"drag",DRAGSTART:"dragstart",DRAGEND:"dragend",HOLD:"hold",TAP:"tap",DOUBLE_TAP:"doubletap"},ae={start:null,move:null,end:null},ad=0,ac=null,ab=null,aa=null,Z=!1,Y=!1,X=!1,W={},V=!1,U=null,S=!1,Q=null,O=1,M=!1,K=[],J=0,I=0,H=0,G=null,F={getAngleDiff:function(b){for(var f=parseInt(J-ai.getAngle180(b[0],b[1]),10),e=0;Math.abs(f-I)>90&&e++<50;){0>I?f-=180:f+=180}return I=parseInt(f,10)},pinch:function(r){var q=r.target;if(ag.pinch){if(!V){return}if(ai.getFingers(r)<2&&!ai.isTouchEnd(r)){return}var o=ai.calScale(ae.start,ae.move),l=this.getAngleDiff(ae.move),f={type:"",originEvent:r,scale:o,rotation:l,direction:l>0?"right":"left",fingersCount:ai.getFingers(r)};if(Y?ai.isTouchMove(r)?(f.fingerStatus="move",ah.trigger(q,af.PINCH,f)):ai.isTouchEnd(r)&&(f.fingerStatus="end",ah.trigger(q,af.PINCH_END,f),ai.reset()):(Y=!0,f.fingerStatus="start",ah.trigger(q,af.PINCH_START,f)),Math.abs(1-o)>ag.minScaleRate){var e=ai.simpleClone(f),d=1e-11;o>O?(O=o-d,ah.trigger(q,af.PINCH_OUT,e,!1)):O>o&&(O=o+d,ah.trigger(q,af.PINCH_IN,e,!1)),ai.isTouchEnd(r)&&(O=1)}if(Math.abs(l)>ag.minRotationAngle){var c,b=ai.simpleClone(f);c=l>0?af.ROTATION_RIGHT:af.ROTATION_LEFT,ah.trigger(q,c,b,!1),ah.trigger(q,af.ROTATION,f)}}},rotateSingleFinger:function(b){var n=b.target;if(M&&ai.getFingers(b)<2){if(!ae.move){return}if(K.length<2){var m=ai.getXYByElement(n);K=[{x:m.left+n.offsetWidth/2,y:m.top+n.offsetHeight/2},ae.move[0]],J=parseInt(ai.getAngle180(K[0],K[1]),10)}var l=[K[0],ae.move[0]],f=this.getAngleDiff(l),e={type:"",originEvent:b,rotation:f,direction:f>0?"right":"left",fingersCount:ai.getFingers(b)};ai.isTouchMove(b)?e.fingerStatus="move":(ai.isTouchEnd(b)||"mouseout"===b.type)&&(e.fingerStatus="end",ah.trigger(n,af.PINCH_END,e),ai.reset());var c=f>0?af.ROTATION_RIGHT:af.ROTATION_LEFT;ah.trigger(n,c,e),ah.trigger(n,af.ROTATION,e)}},swipe:function(m){var k=m.target;if(V&&ae.move&&!(ai.getFingers(m)>1)){var g=Date.now(),f=g-ad,e=ai.getDistance(ae.start[0],ae.move[0]),d={x:ae.move[0].x-W.left,y:ae.move[0].y-W.top},c=ai.getAngle(ae.start[0],ae.move[0]),b=ai.getDirectionFromAngle(c),x=f/1000,w=10*(10-ag.swipeFactor)*x*x,o={type:af.SWIPE,originEvent:m,position:d,direction:b,distance:e,distanceX:ae.move[0].x-ae.start[0].x,distanceY:ae.move[0].y-ae.start[0].y,x:ae.move[0].x-ae.start[0].x,y:ae.move[0].y-ae.start[0].y,angle:c,duration:f,fingersCount:ai.getFingers(m),factor:w};if(ag.swipe){var n=function(){var h=af;switch(b){case"up":ah.trigger(k,h.SWIPE_UP,o);break;case"down":ah.trigger(k,h.SWIPE_DOWN,o);break;case"left":ah.trigger(k,h.SWIPE_LEFT,o);break;case"right":ah.trigger(k,h.SWIPE_RIGHT,o)}};Z?ai.isTouchMove(m)?(o.fingerStatus=o.swipe="move",ah.trigger(k,af.SWIPING,o),f>ag.swipeTime&&f<ag.swipeTime+50&&e>ag.swipeMinDistance&&(n(),ah.trigger(k,af.SWIPE,o,!1))):(ai.isTouchEnd(m)||"mouseout"===m.type)&&(o.fingerStatus=o.swipe="end",ah.trigger(k,af.SWIPE_END,o),ag.swipeTime>f&&e>ag.swipeMinDistance&&(n(),ah.trigger(k,af.SWIPE,o,!1))):(o.fingerStatus=o.swipe="start",Z=!0,ah.trigger(k,af.SWIPE_START,o))}ag.drag&&(X?ai.isTouchMove(m)?(o.fingerStatus=o.swipe="move",ah.trigger(k,af.DRAG,o)):ai.isTouchEnd(m)&&(o.fingerStatus=o.swipe="end",ah.trigger(k,af.DRAGEND,o)):(o.fingerStatus=o.swipe="start",X=!0,ah.trigger(k,af.DRAGSTART,o)))}},tap:function(c){var g=c.target;if(ag.tap){var f=Date.now(),e=f-ad,d=ai.getDistance(ae.start[0],ae.move?ae.move[0]:ae.start[0]);clearTimeout(U);var b=function(){if(G&&ag.doubleTap&&ad-H<ag.maxDoubleTapInterval){var h=ai.getDistance(G,ae.start[0]);if(16>h){return !0}}return !1}();if(b){return clearTimeout(Q),void ah.trigger(g,af.DOUBLE_TAP,{type:af.DOUBLE_TAP,originEvent:c,position:ae.start[0]})}if(ag.tapMaxDistance<d){return}ag.holdTime>e&&ai.getFingers(c)<=1&&(S=!0,H=f,G=ae.start[0],Q=setTimeout(function(){ah.trigger(g,af.TAP,{type:af.TAP,originEvent:c,fingersCount:ai.getFingers(c),position:G})},ag.tapTime))}},hold:function(b){var c=b.target;ag.hold&&(clearTimeout(U),U=setTimeout(function(){if(ae.start){var a=ai.getDistance(ae.start[0],ae.move?ae.move[0]:ae.start[0]);ag.tapMaxDistance<a||S||ah.trigger(c,"hold",{type:"hold",originEvent:b,fingersCount:ai.getFingers(b),position:ae.start[0]})}},ag.holdTime))}},T=function(b){var h=b.target;switch(b.type){case"touchstart":case"mousedown":K=[],V=!0,(!ae.start||ae.start.length<2)&&(ae.start=ai.getPosOfEvent(b)),ai.getFingers(b)>=2&&(J=parseInt(ai.getAngle180(ae.start[0],ae.start[1]),10)),ad=Date.now(),ac=b,W={};var g=h.getBoundingClientRect(),f=document.documentElement;W={top:g.top+(window.pageYOffset||f.scrollTop)-(f.clientTop||0),left:g.left+(window.pageXOffset||f.scrollLeft)-(f.clientLeft||0)},F.hold(b);break;case"touchmove":case"mousemove":if(!V||!ae.start){return}ae.move=ai.getPosOfEvent(b),ai.getFingers(b)>=2?F.pinch(b):M?F.rotateSingleFinger(b):F.swipe(b);break;case"touchend":case"touchcancel":case"mouseup":case"mouseout":if(!V){return}aa=b,Y?F.pinch(b):M?F.rotateSingleFinger(b):Z?F.swipe(b):F.tap(b),ai.reset(),J=0,I=0,b.touches&&1===b.touches.length&&(V=!0,M=!0)}},R=function(){function v(d){ai.hasTouch||(d=ai.getPCevts(d)),o.forEach(function(a){ah.delegate(a,d,q,r[d])})}function u(d){ai.hasTouch||(d=ai.getPCevts(d)),o.forEach(function(a){ah.bind(a,d,r[d])})}var t,s,r,q,p=arguments;if(p.length<2||p>4){return console.error("unexpected arguments!")}var o="string"===ai.getType(p[0])?document.querySelectorAll(p[0]):p[0];if(o=o.length?Array.prototype.slice.call(o):[o],3===p.length&&"string"===ai.getType(p[1])){return t=p[1].split(" "),s=p[2],void t.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),o.forEach(function(a){ah.bind(a,d,s)})})}if(3!==p.length||"object"!==ai.getType(p[1])){if(2!==p.length||"object"!==ai.getType(p[1])){if(4===p.length&&"object"===ai.getType(p[2])){return t=p[1].split(" "),s=p[3],void t.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),o.forEach(function(a){ah.bind(a,d,s)})})}if(4===p.length){var n=o[0];return t=p[1].split(" "),q=p[2],s=p[3],void t.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),ah.delegate(n,d,q,s)})}}else{r=p[1];for(var c in r){u(c)}}}else{r=p[1],q=p[2];for(var b in r){v(b)}}},P=function(){var b,j,i=arguments;if(i.length<1||i.length>4){return console.error("unexpected arguments!")}var h="string"===ai.getType(i[0])?document.querySelectorAll(i[0]):i[0];if(h=h.length?Array.prototype.slice.call(h):[h],1===i.length||2===i.length){return void h.forEach(function(a){b=i[1]?i[1].split(" "):Object.keys(a.listeners),b.length&&b.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),ah.unbind(a,d),ah.undelegate(a,d)})})}if(3===i.length&&"function"===ai.getType(i[2])){return j=i[2],void h.forEach(function(a){b=i[1].split(" "),b.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),ah.unbind(a,d,j)})})}if(3===i.length&&"string"===ai.getType(i[2])){var c=i[2];return void h.forEach(function(a){b=i[1].split(" "),b.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),ah.undelegate(a,d,c)})})}return 4===i.length?(j=i[3],void h.forEach(function(a){b=i[1].split(" "),b.forEach(function(d){ai.hasTouch||(d=ai.getPCevts(d)),ah.undelegate(a,d,c,j)})})):void 0},N=function(b,j,i){var h=arguments;ai.hasTouch||(j=ai.getPCevts(j));var c="string"===ai.getType(h[0])?document.querySelectorAll(h[0]):h[0];c=c.length?Array.prototype.call(c):[c],c.forEach(function(d){ah.trigger(d,j,i)})};aj();var L={};return L.on=L.bind=L.live=R,L.off=L.unbind=L.die=P,L.config=ag,L.trigger=N,L});